-----------------------------------------------------------------------------------------------
------------------------------------- Model 9 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Indexing
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Resnet_scratch/checkpoint_res.pth and loaded with msg: _IncompatibleKeys(missing_keys=['fc.weight', 'fc.bias'], unexpected_keys=[])
stat
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Resnet_scratch/checkpoint_res.pth and loaded with msg: _IncompatibleKeys(missing_keys=['fc.weight', 'fc.bias'], unexpected_keys=[])
all
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Resnet_scratch/checkpoint_res.pth and loaded with msg: _IncompatibleKeys(missing_keys=['fc.weight', 'fc.bias'], unexpected_keys=[])
weighted
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Resnet_scratch/checkpoint_res.pth and loaded with msg: _IncompatibleKeys(missing_keys=['fc.weight', 'fc.bias'], unexpected_keys=[])
-----------------------------------------------------------------------------------------------
------------------------------------- Model 10 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Indexing
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_pretrained/checkpoint0099_pretrained.pth and loaded with msg: <All keys matched successfully>
Time of the model: 2.6934523582458496
Time of the transfer: 46.81924891471863
Time of the indexing: 3.865058183670044
T_indexing = 64.30858135223389
stat
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_pretrained/checkpoint0099_pretrained.pth and loaded with msg: <All keys matched successfully>
Top 1 accuracy:  0.6478431372549021  +-  0.006887909047156982
Top 5 accuracy:  0.818921568627451  +-  0.005980392156862724
Maj accuracy:  0.6359803921568628  +-  0.0068213034458035225
Top 1 accuracy on project:  0.9294117647058823  +-  0.004018412065082182
Top 5 accuracy on project:  0.9547058823529412  +-  0.0022697719417236017
Maj accuracy on project:  0.9293137254901961  +-  0.0033520237249566073
Top 1 accuracy on sim:  0.9307843137254903  +-  0.004475573415887564
Top 5 accuracy on sim:  0.9564705882352941  +-  0.002745098039215699
Maj accuracy on sim:  0.9302941176470588  +-  0.003323225736603575
t_tot: 0.009620461674297556 +- 0.0002151484490204646
t_model: 0.0015290781797147267 +- 0.00019784209620733232
t_transfer: 9.880898045558557e-05 +- 3.086524399549363e-06
t model complet: 0.0016278871601703119 +- 0.00019772869838722635
t_search: 0.007838580795362884 +- 0.0001457239670079429
all
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_pretrained/checkpoint0099_pretrained.pth and loaded with msg: <All keys matched successfully>
top-1 accuracy :  [0.76993942]
top-5 accuracy :  [0.88994025]
top-1 accuracy proj :  [0.92798701]
top-5 accuracy proj :  [0.94529802]
top-1 accuracy sim :  [0.93011055]
top-5 accuracy sim :  [0.94821269]
maj accuracy class :  [0.77762164]
maj accuracy proj :  [0.9260092]
maj accuracy sim :  [0.92853871]
t_tot: 903.7277882099152
t_model: 138.12673568725586
t_transfer: 10.718294858932495
t_search: 740.3734204769135
weighted
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_pretrained/checkpoint0099_pretrained.pth and loaded with msg: <All keys matched successfully>
top-1 accuracy :  [0.66103206]
top-5 accuracy :  [0.81590652]
top-1 accuracy proj :  [0.93607663]
top-5 accuracy proj :  [0.95875307]
top-1 accuracy sim :  [0.93722797]
top-5 accuracy sim :  [0.95982541]
maj accuracy class :  [0.62896034]
maj accuracy proj :  [0.92930696]
maj accuracy sim :  [0.93041745]
t_tot: 927.7679903507233
t_model: 140.87985277175903
t_transfer: 9.538893222808838
t_search: 762.5006561279297
-----------------------------------------------------------------------------------------------
------------------------------------- Model 11 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Indexing
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_scratch/checkpoint0099_scratch.pth and loaded with msg: <All keys matched successfully>
Time of the model: 2.496931314468384
Time of the transfer: 46.83427333831787
Time of the indexing: 3.891909122467041
T_indexing = 64.38180994987488
stat
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_scratch/checkpoint0099_scratch.pth and loaded with msg: <All keys matched successfully>
Top 1 accuracy:  0.6626470588235296  +-  0.00711645860547431
Top 5 accuracy:  0.8273529411764706  +-  0.006553978397395427
Maj accuracy:  0.6641176470588237  +-  0.010171539097523882
Top 1 accuracy on project:  0.928921568627451  +-  0.004807921504015388
Top 5 accuracy on project:  0.9561764705882352  +-  0.0036696014259241295
Maj accuracy on project:  0.9301960784313724  +-  0.003502072764606213
Top 1 accuracy on sim:  0.9302941176470588  +-  0.0046286555427893705
Top 5 accuracy on sim:  0.9572549019607843  +-  0.004164070702273607
Maj accuracy on sim:  0.9320588235294117  +-  0.004206556461357816
t_tot: 0.009509057928534114 +- 0.00019896927908070577
t_model: 0.0015257097926794313 +- 0.0002017765871598928
t_transfer: 9.904971309736664e-05 +- 2.442641848779038e-06
t model complet: 0.0016247595057767982 +- 0.00020133142490419794
t_search: 0.007731367279501522 +- 0.00015408966536844726
all
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_scratch/checkpoint0099_scratch.pth and loaded with msg: <All keys matched successfully>
top-1 accuracy :  [0.7758312]
top-5 accuracy :  [0.89353153]
top-1 accuracy proj :  [0.93130764]
top-5 accuracy proj :  [0.94880603]
top-1 accuracy sim :  [0.93360814]
top-5 accuracy sim :  [0.95158537]
maj accuracy class :  [0.78370079]
maj accuracy proj :  [0.92867404]
maj accuracy sim :  [0.93138051]
t_tot: 897.2642285823822
t_model: 137.474458694458
t_transfer: 11.088224172592163
t_search: 734.0318865776062
weighted
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_scratch/checkpoint0099_scratch.pth and loaded with msg: <All keys matched successfully>
-----------------------------------------------------------------------------------------------
------------------------------------- Model 12 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Indexing
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_pretrained/pretrained_vit_small_checkpoint.pth and loaded with msg: <All keys matched successfully>
Time of the model: 2.566843271255493
Time of the transfer: 46.84758758544922
Time of the indexing: 3.7562341690063477
T_indexing = 64.26304388046265
stat
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_pretrained/pretrained_vit_small_checkpoint.pth and loaded with msg: <All keys matched successfully>
Top 1 accuracy:  0.6071568627450981  +-  0.010713223799007836
Top 5 accuracy:  0.8125490196078431  +-  0.008499496784977736
Maj accuracy:  0.5862745098039215  +-  0.008724939396583151
Top 1 accuracy on project:  0.9096078431372548  +-  0.007642029517609826
Top 5 accuracy on project:  0.9534313725490196  +-  0.0043459137763336535
Maj accuracy on project:  0.9123529411764706  +-  0.007004145529212443
Top 1 accuracy on sim:  0.9109803921568627  +-  0.007766785223662095
Top 5 accuracy on sim:  0.955392156862745  +-  0.004540602422317434
Maj accuracy on sim:  0.9139215686274509  +-  0.007094138241225695
t_tot: 0.009779303891986023 +- 0.0001746920563583972
t_model: 0.0015227653466018975 +- 0.00018672270497621803
t_transfer: 0.00010934715177498614 +- 3.160865666758746e-06
t model complet: 0.0016321124983768836 +- 0.00018874949822116202
t_search: 0.007995043876124363 +- 0.00020280980834488214
all
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_pretrained/pretrained_vit_small_checkpoint.pth and loaded with msg: <All keys matched successfully>
top-1 accuracy :  [0.75904066]
top-5 accuracy :  [0.90375367]
top-1 accuracy proj :  [0.93193221]
top-5 accuracy proj :  [0.9568734]
top-1 accuracy sim :  [0.93328545]
top-5 accuracy sim :  [0.95790394]
maj accuracy class :  [0.77018924]
maj accuracy proj :  [0.93293153]
maj accuracy sim :  [0.93479483]
t_tot: 887.0136408805847
t_model: 138.76985263824463
t_transfer: 11.67067551612854
t_search: 722.1261429786682
weighted
Loaded pretrained weights for efficientnet-b0
Pretrained weights found at /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/Dino/Vit_pretrained/pretrained_vit_small_checkpoint.pth and loaded with msg: <All keys matched successfully>
top-1 accuracy :  [0.62418317]
top-5 accuracy :  [0.80274378]
top-1 accuracy proj :  [0.91285261]
top-5 accuracy proj :  [0.96000147]
top-1 accuracy sim :  [0.9141216]
top-5 accuracy sim :  [0.96171856]
maj accuracy class :  [0.57258714]
maj accuracy proj :  [0.91729571]
maj accuracy sim :  [0.91893994]
t_tot: 884.2596755027771
t_model: 138.85995030403137
t_transfer: 10.709731578826904
t_search: 720.4186723232269
-----------------------------------------------------------------------------------------------
------------------------------------- Model 13 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/deit/v3_alan/last epoch
Indexing
Loaded pretrained weights for efficientnet-b0
Error with the loading of the model's weights:  [Errno 2] No such file or directory: '/home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/deit/v3_alan/last epoch'
Exiting...
stat
Loaded pretrained weights for efficientnet-b0
Error with the loading of the model's weights:  [Errno 2] No such file or directory: '/home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/deit/v3_alan/last epoch'
Exiting...
all
Loaded pretrained weights for efficientnet-b0
Error with the loading of the model's weights:  [Errno 2] No such file or directory: '/home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/deit/v3_alan/last epoch'
Exiting...
weighted
Loaded pretrained weights for efficientnet-b0
Error with the loading of the model's weights:  [Errno 2] No such file or directory: '/home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/deit/v3_alan/last epoch'
Exiting...
-----------------------------------------------------------------------------------------------
------------------------------------- Model 14 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/resnet/v1_alan/last epoch
Indexing
Loaded pretrained weights for efficientnet-b0
Error with the loading of the model's weights:  [Errno 2] No such file or directory: '/home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/resnet/v1_alan/last epoch'
Exiting...
stat
Loaded pretrained weights for efficientnet-b0
Error with the loading of the model's weights:  [Errno 2] No such file or directory: '/home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/resnet/v1_alan/last epoch'
Exiting...
all
Loaded pretrained weights for efficientnet-b0
Error with the loading of the model's weights:  [Errno 2] No such file or directory: '/home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/resnet/v1_alan/last epoch'
Exiting...
weighted
Loaded pretrained weights for efficientnet-b0
Error with the loading of the model's weights:  [Errno 2] No such file or directory: '/home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/resnet/v1_alan/last epoch'
Exiting...
-----------------------------------------------------------------------------------------------
------------------------------------- Model 13 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/deit/v3_alan/last_epoch
Indexing
Loaded pretrained weights for efficientnet-b0
Time of the model: 2.8213746547698975
Time of the transfer: 134.5083408355713
Time of the indexing: 3.542212963104248
T_indexing = 151.9055836200714
stat
Loaded pretrained weights for efficientnet-b0
Top 1 accuracy:  0.302156862745098  +-  0.007066988741545134
Top 5 accuracy:  0.527450980392157  +-  0.009028128967232436
Maj accuracy:  0.23794117647058824  +-  0.006474300776901588
Top 1 accuracy on project:  0.6158823529411764  +-  0.013405227164813491
Top 5 accuracy on project:  0.7948039215686274  +-  0.007645173221522335
Maj accuracy on project:  0.5739215686274509  +-  0.011782666029469504
Top 1 accuracy on sim:  0.6912745098039216  +-  0.010508505187534132
Top 5 accuracy on sim:  0.852843137254902  +-  0.007599778422071973
Maj accuracy on sim:  0.6637254901960785  +-  0.010775397383556139
t_tot: 0.006174141869825476 +- 0.00022891522850320223
t_model: 0.0019115402651768108 +- 0.0002169777151554329
t_transfer: 0.0012804755276324702 +- 1.711029304448033e-05
t model complet: 0.0031920157928092808 +- 0.00022497032728298488
t_search: 0.0028244511052673937 +- 3.9003670257943486e-05
all
Loaded pretrained weights for efficientnet-b0
top-1 accuracy :  [0.56294631]
top-5 accuracy :  [0.77033498]
top-1 accuracy proj :  [0.71686132]
top-5 accuracy proj :  [0.86775758]
top-1 accuracy sim :  [0.8315429]
top-5 accuracy sim :  [0.93981221]
maj accuracy class :  [0.5371099]
maj accuracy proj :  [0.71271834]
maj accuracy sim :  [0.84182749]
t_tot: 585.5269947052002
t_model: 177.545348405838
t_transfer: 122.57977080345154
t_search: 270.38201928138733
weighted
Loaded pretrained weights for efficientnet-b0
top-1 accuracy :  [0.30011719]
top-5 accuracy :  [0.50194476]
top-1 accuracy proj :  [0.58749781]
top-5 accuracy proj :  [0.77756674]
top-1 accuracy sim :  [0.65081141]
top-5 accuracy sim :  [0.8247541]
maj accuracy class :  [0.21160898]
maj accuracy proj :  [0.53172838]
maj accuracy sim :  [0.60610923]
t_tot: 580.103268623352
t_model: 178.54295206069946
t_transfer: 122.10805678367615
t_search: 264.4118072986603
-----------------------------------------------------------------------------------------------
------------------------------------- Model 14 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/labarvr4090/Documents/Axelle/cytomine/cbir-tfe/weights_folder/resnet/v1_alan/last_epoch
Indexing
Loaded pretrained weights for efficientnet-b0
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
  )
  (layer2): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (3): Bottleneck(
      (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
  )
  (layer3): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (3): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (4): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (5): Bottleneck(
      (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
  )
  (layer4): Sequential(
    (0): Bottleneck(
      (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (downsample): Sequential(
        (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): Bottleneck(
      (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (2): Bottleneck(
      (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=2048, out_features=1000, bias=True)
)
Time of the model: 3.6457722187042236
Time of the transfer: 46.09778451919556
Time of the indexing: 3.843644142150879
T_indexing = 64.65355849266052
stat
Loaded pretrained weights for efficientnet-b0
Top 1 accuracy:  0.7253921568627452  +-  0.009519905691913631
Top 5 accuracy:  0.883235294117647  +-  0.004871473823060724
Maj accuracy:  0.7315686274509804  +-  0.010782531046954919
Top 1 accuracy on project:  0.9470588235294116  +-  0.0030058254346580072
Top 5 accuracy on project:  0.967549019607843  +-  0.003051839689465358
Maj accuracy on project:  0.9455882352941176  +-  0.0034313725490195957
Top 1 accuracy on sim:  0.9475490196078431  +-  0.0029817463383814695
Top 5 accuracy on sim:  0.9677450980392157  +-  0.0032054475929944623
Maj accuracy on sim:  0.9457843137254901  +-  0.0037216182149220323
t_tot: 0.005974494966806149 +- 0.00013243403211163002
t_model: 0.0025752627382091453 +- 0.00019712193964770128
t_transfer: 0.0002519649617812213 +- 2.043640205251629e-06
t model complet: 0.0028272276999903663 +- 0.00019809270052322057
t_search: 0.0029898718759125355 +- 8.688045623270069e-05
all
Loaded pretrained weights for efficientnet-b0
top-1 accuracy :  [0.83311473]
top-5 accuracy :  [0.93243187]
top-1 accuracy proj :  [0.95124185]
top-5 accuracy proj :  [0.96697062]
top-1 accuracy sim :  [0.95126267]
top-5 accuracy sim :  [0.96698103]
maj accuracy class :  [0.85336123]
maj accuracy proj :  [0.95134595]
maj accuracy sim :  [0.95135636]
t_tot: 543.4397892951965
t_model: 241.76754689216614
t_transfer: 23.128735542297363
t_search: 263.58688163757324
weighted
Loaded pretrained weights for efficientnet-b0
